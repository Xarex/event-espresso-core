(this.webpackJsonproot=this.webpackJsonproot||[]).push([[6],{2347:function(e,t,a){"use strict";var n=a(0),l=a.n(n),r=a(2338),c=a(4),s=a(40),i=a(23),o=a(11),u=a(32),m=a(20),b=function(e){var t=e.datetime,a=Object(o.useConfig)().siteUrl.admin,n=Object(i.getAdminUrl)({adminSiteUrl:a,page:s.ADMIN_ROUTES.REGISTRATIONS}),b=Object(i.useEventId)(),d=Object(r.addQueryArgs)(n,{event_id:b,datetime_id:t.dbId,return:"edit"}),p=Object(c.__)("view registrations for this date."),y=Object(u.useMemoStringify)({placement:"top"});return l.a.createElement(m.RegistrationsLink,{href:d,tooltip:p,tooltipProps:y})};t.a=l.a.memo(b,Object(o.getPropsAreEqual)(["datetime","cacheId"]))},2348:function(e,t,a){"use strict";var n=a(0),l=a.n(n),r=a(11),c=a(20),s=a(23),i=function(e){var t=e.entity,a=Object(s.useDatetimeMutator)(t.id).updateEntity,i=Object(s.useUpdateRelatedTickets)(t.id),o=Object(s.useTicketQuantityForCapacity)(),u=Object(n.useCallback)((function(e){var n=Object(r.parseInfinity)(e);if(n!==t.capacity){a({capacity:n});var l=o(n);i(l)}}),[t.capacity,a,o,i]);return l.a.createElement(c.InlineEditInfinity,{onChangeValue:u,value:"".concat(t.capacity)})};t.a=l.a.memo(i,Object(r.getPropsAreEqual)(["entity"]))},2349:function(e,t,a){},2353:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return b}));var n=a(0),l=a.n(n),r=a(4),c=a(23),s=a(20),i=a(11),o=function(e){var t=e.entity,a=e.className,i=Object(c.useDatetimeMutator)(t.id).updateEntity,o=Object(n.useCallback)((function(e){e!==t.description&&i({description:e})}),[t.description,i]),u=t.description?t.description:Object(r.__)("Edit description...");return l.a.createElement(s.InlineEditTextArea,{className:a,onChangeValue:o,value:u})},u=l.a.memo(o,Object(i.getPropsAreEqual)(["entity","description"])),m=function(e){var t=e.className,a=e.entity,i=e.view,o=void 0===i?"card":i,u=Object(c.useDatetimeMutator)(a.id).updateEntity,m=a.name?a.name:Object(r.__)("Edit title..."),b=Object(n.useCallback)((function(e){e!==a.name&&u({name:e})}),[a.name,u]);return l.a.createElement(s.InlineEditText,{fitText:"card"===o,tag:"table"===o?"p":"h4",className:t,onChangeValue:b,value:m})},b=l.a.memo(m,Object(i.getPropsAreEqual)(["entity","name"]))},2354:function(e,t,a){"use strict";var n=a(3),l=a.n(n),r=a(9),c=a.n(r),s=a(0),i=a.n(s),o=a(20),u=a(857),m=function(e){return Object(u.b)("datetime",e)},b=a(11),d=function(e){var t=e.entity,a=c()(e,["entity"]),n=m(t);return i.a.createElement(o.EntityActionsMenu,l()({},a,{menuItems:n}))};t.a=i.a.memo(d,Object(b.getPropsAreEqual)(["entity","cacheId"]))},2356:function(e,t,a){},2357:function(e,t,a){},2358:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(4),c=a(20),s=a(23),i=a(3),o=a.n(i),u=a(709),m=function(e){var t=Object(u.useEdtrState)().visibleDatetimeIds;return l.a.createElement(c.ActionCheckbox,o()({},e,{visibleEntityIds:t}))},b=function(){return Object(n.useCallback)((function(e){var t=e.displayStartOrEndDate;return{cells:[{key:"stripe",type:"cell",className:"ee-date-list-col-hdr ee-entity-list-status-stripe ee-rspnsv-table-column-nano",value:""},{key:"checkbox",type:"cell",className:"ee-date-list-col-hdr ee-date-list-col-checkbox ee-rspnsv-table-column-micro",value:l.a.createElement(m,null)},{key:"id",type:"cell",className:"ee-date-list-col-hdr ee-date-list-col-id ee-number-column ee-rspnsv-table-column-nano",value:Object(r.__)("ID")},{key:"name",type:"cell",className:"ee-date-list-col-hdr ee-date-list-col-name ee-rspnsv-table-column-huge",value:Object(r.__)("Name")},{key:"start",type:"cell",className:"ee-date-list-col-hdr ee-date-list-col-name-start ee-rspnsv-table-column-default",value:l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"ee-rspnsv-table-long-label"},Object(r.__)("Start Date")),l.a.createElement("span",{className:"ee-rspnsv-table-short-label"},Object(r.__)("Start")))},{key:"end",type:"cell",className:"ee-date-list-col-hdr ee-date-list-col-end ee-rspnsv-table-column-default",value:l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"ee-rspnsv-table-long-label"},Object(r.__)("End Date")),l.a.createElement("span",{className:"ee-rspnsv-table-short-label"},Object(r.__)("End")))},{key:"capacity",type:"cell",className:"ee-date-list-col-hdr ee-date-list-col-capacity ee-rspnsv-table-column-tiny ee-number-column",value:l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"ee-rspnsv-table-long-label"},Object(r.__)("Capacity")),l.a.createElement("span",{className:"ee-rspnsv-table-short-label"},Object(r.__)("Cap")))},{key:"sold",type:"cell",className:"ee-date-list-col-hdr ee-date-list-col-sold ee-rspnsv-table-column-tiny ee-number-column",value:Object(r.__)("Sold")},{key:"registrations",type:"cell",className:"ee-date-list-col-hdr ee-date-list-col-registrations ee-rspnsv-table-column-smaller ee-centered-column",value:l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"ee-rspnsv-table-long-label"},Object(r.__)("Reg list")),l.a.createElement("span",{className:"ee-rspnsv-table-short-label"},Object(r.__)("Regs")))},{key:"actions",type:"cell",className:"ee-date-list-col-hdr ee-actions-column ee-rspnsv-table-column-big ee-centered-column",value:l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"ee-rspnsv-table-long-label"},Object(r.__)("Actions")),l.a.createElement("span",{className:"ee-rspnsv-table-short-label"},Object(r.__)("Actions")))}].filter(Object(s.filterCellByStartOrEndDate)(t)),className:"ee-editor-date-list-items-header-row",key:"dates-list-header",primary:!0,type:"row"}}),[])},d=a(22),p=a(10),y=a(2347),O=a(2354),v=a(40),f=a(1081),j=a(11),E=a(2348),_=a(2353),g=(a(2349),Object(c.addZebraStripesOnMobile)(["row","stripe","name","actions"])),h=function(){return Object(n.useCallback)((function(e){var t=e.entity,a=e.filterState,n=a.displayStartOrEndDate,r=a.sortingEnabled,c=Object(f.getDatetimeBackgroundColorClassName)(t),i=t.dbId||Object(j.shortenGuid)(t.id),o=Object(f.datetimeStatus)(t),u={key:"capacity",type:"cell",className:"ee-date-list-cell ee-date-list-col-capacity ee-rspnsv-table-column-tiny ee-number-column",value:r?t.capacity:l.a.createElement(E.a,{entity:t})},b={key:"name",type:"cell",className:"ee-date-list-cell ee-date-list-col-name ee-col-name ee-rspnsv-table-column-bigger ee-rspnsv-table-hide-on-mobile",value:r?t.name:l.a.createElement(_.b,{className:"ee-entity-list-text ee-focus-priority-5",entity:t,view:"table"})},h=[{key:"stripe",type:"cell",className:"ee-date-list-cell ee-entity-list-status-stripe ".concat(c," ee-rspnsv-table-column-nano"),value:l.a.createElement("div",{className:"ee-rspnsv-table-show-on-mobile"},t.name)},{key:"checkbox",type:"cell",className:"ee-date-list-cell ee-date-list-col-checkbox ee-rspnsv-table-column-micro",value:l.a.createElement(m,{id:t.id})},{key:"id",type:"cell",className:"ee-date-list-cell ee-date-list-col-id ee-rspnsv-table-column-nano ee-number-column",value:i},b,{key:"start",type:"cell",className:"ee-date-list-cell ee-date-list-col-start ee-rspnsv-table-column-default",value:Object(d.format)(new Date(t.startDate),v.ENTITY_LIST_DATE_TIME_FORMAT)},{key:"end",type:"cell",className:"ee-date-list-cell ee-date-list-col-end ee-rspnsv-table-column-default",value:Object(d.format)(new Date(t.endDate),v.ENTITY_LIST_DATE_TIME_FORMAT)},u,{key:"sold",type:"cell",className:"ee-date-list-cell ee-date-list-col-sold ee-rspnsv-table-column-tiny ee-number-column",value:t.sold||0},{key:"registrations",type:"cell",className:"ee-date-list-cell ee-date-list-col-registrations ee-rspnsv-table-column-smaller ee-centered-column",value:r?"-":l.a.createElement(y.a,{datetime:t})},{key:"actions",type:"cell",className:"ee-date-list-cell ee-date-list-col-actions ee-actions-column ee-rspnsv-table-column-big",value:r?"-":l.a.createElement(O.a,{entity:t})}],k=Object(p.m)(Object(s.filterCellByStartOrEndDate)(n));return{cells:Object(p.H)(k,g)(h),className:"ee-editor-date-list-view-row ".concat(o),id:"ee-editor-date-list-view-row-".concat(t.id),key:"row-".concat(t.id),type:"row"}}),[])},k=a(1377),N=a(26),D=a.n(N),S=a(184),w=a(21),T=a(32),C=l.a.memo((function(e){var t=e.value,a=e.setValue,n=Object(T.useMemoStringify)([{value:"",label:Object(r.__)("bulk actions")},{value:"edit-details",label:Object(r.__)("edit datetime details")},{value:"delete",label:Object(r.__)("delete datetimes")}]);return l.a.createElement(c.SelectInput,{value:t,options:n,onChangeValue:a})})),I=a(7),A=a.n(I),P=a(2344),x=a(2345),R=a(2346),F=a(250),B=a.n(F),M=a(623),V=a.n(M),q=a(655),L=a(474),G=function(){var e=V()(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(L.yupToFinalFormErrors)(U,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=q.object({name:q.string().min(3,(function(){return Object(r.__)("Name must be at least three characters")}))});function W(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?W(Object(a),!0).forEach((function(t){A()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):W(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var J=Object(j.intervalsToOptions)(Object(p.F)(["months","weeks","days","hours","minutes"],j.DATE_INTERVALS),!0),Q=function(e){var t=e.onSubmit,a=Object(n.useCallback)((function(e,a){for(var n=arguments.length,l=new Array(n>2?n-2:0),r=2;r<n;r++)l[r-2]=arguments[r];return t.apply(void 0,[e,a].concat(l))}),[t]),l=Object(T.useMemoStringify)({className:"ee-form-item-pair"});return Object(n.useMemo)((function(){return Y(Y({},e),{},{onSubmit:a,validate:G,layout:"horizontal",debugFields:["values","errors"],sections:[{name:"basics",icon:P.a,title:Object(r.__)("Basics"),fields:[{name:"name",label:Object(r.__)("Name"),fieldType:"text",min:3},{name:"description",label:Object(r.__)("Description"),fieldType:"textarea"}]},{name:"dates",icon:x.a,title:Object(r.__)("Dates"),fields:[{name:"shiftDates",label:Object(r.__)("Shift dates"),fieldType:"group",formControlProps:{className:"shift-dates"},subFields:[{name:"value",fieldType:"number",min:1},{name:"unit",fieldType:"select",options:J},{name:"type",fieldType:"select",options:[{label:"",value:""},{label:Object(r.__)("earlier"),value:"earlier"},{label:Object(r.__)("later"),value:"later"}]}]}]},{name:"details",icon:R.a,title:Object(r.__)("Details"),fields:[{name:"capacity",label:Object(r.__)("Capacity"),fieldType:"number",parseAsInfinity:!0,min:-1,formControlProps:l}]}]})}),[l,e,a])},z=function(){return l.a.createElement("div",{className:"ee-form-error-message"},l.a.createElement("p",null,Object(r.__)("Note: "),Object(r.__)("any changes will be applied to ALL of the selected dates.")))},H={submitting:!0,hasValidationErrors:!0,hasSubmitErrors:!0,pristine:!0},Z=function(e){var t=e.form,a=Object(n.useState)({}),s=D()(a,2),i=s[0],o=s[1],u=i.submitting,m=i.hasValidationErrors,b=i.hasSubmitErrors,d=i.pristine,p=u||m||b;Object(n.useEffect)((function(){return t.subscribe((function(e){o(e)}),H)}),[]);var y=Object(c.useConfirmationDialog)({message:Object(r.__)("Are you sure you want to update the selected dates?"),title:Object(r.__)("Bulk update date details"),onConfirm:t.submit}),O=y.confirmationDialog,v=y.onOpen;return l.a.createElement(c.ButtonRow,{rightAligned:!0},l.a.createElement(c.Button,{buttonText:Object(r.__)("Submit"),buttonType:c.ButtonType.PRIMARY,isDisabled:p,type:"submit",onClick:v}),O,l.a.createElement(c.Button,{buttonText:Object(r.__)("Reset"),isDisabled:d,type:"reset",onClick:function(){return t.reset()}}))},K=function(e){var t=e.children,a=e.form;return l.a.createElement(l.a.Fragment,null,t,l.a.createElement(Z,{form:a}))},X=a(9),$=a.n(X),ee=a(17);function te(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ae(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?te(Object(a),!0).forEach((function(t){A()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):te(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ne=function(e){var t=Object(j.useBulkEdit)(),a=t.getSelected,l=t.unSelectAll,r=Object(s.useDatetimes)(),c=Object(s.useBulkEditDatetimes)().updateEntities;return Object(n.useCallback)((function(t){var n=t.shiftDates,s=$()(t,["shiftDates"]);e(),l();var i=[];if((null===n||void 0===n?void 0:n.unit)&&(null===n||void 0===n?void 0:n.value)&&(null===n||void 0===n?void 0:n.type)){var o=Object(ee.entitiesWithGuIdInArray)(r,a()),u=Object(j.shiftDate)(n);i=o.map((function(e){var t=u(e.startDate).toISOString(),a=u(e.endDate).toISOString();return{id:e.id,startDate:t,endDate:a}}))}else i=a().map((function(e){return{id:e}}));var m=ae(ae({},s),{},{id:""});c({uniqueInputs:i,sharedInput:m})}),[r,a,e,l,c])},le=(a(2356),function(e){var t=e.onClose,a=ne(t),n=Q({onSubmit:a});return l.a.createElement(c.EntityEditModal,{isOpen:!0,onClose:t,closeOnOverlayClick:!0,title:Object(r.__)("Bulk edit date details")},l.a.createElement(z,null),l.a.createElement(L.EspressoForm,o()({},n,{formWrapper:K})))}),re=function(){var e=Object(n.useState)(""),t=D()(e,2),a=t[0],s=t[1],i=Object(j.useBulkEdit)().getSelected,o=Object(n.useCallback)((function(e){return s(e)}),[]),u=Object(S.useDisclosure)(),m=u.isOpen,b=u.onOpen,d=u.onClose,p=!a||!i().length;return l.a.createElement(w.Box,{display:"flex",alignItems:"center",maxWidth:"fit-content"},l.a.createElement(C,{value:a,setValue:o}),l.a.createElement(c.Button,{onClick:b,buttonText:Object(r.__)("apply"),isDisabled:p}),m&&l.a.createElement(l.a.Fragment,null,"edit-details"===a&&l.a.createElement(le,{onClose:d})))};a(2357),t.default=Object(j.withBulkEdit)((function(){var e=Object(k.c)(),t=e.filterState,a=e.filteredEntities,n=Object(s.useReorderDatetimes)(a).sortResponder,i=h(),o=b();return l.a.createElement(l.a.Fragment,null,l.a.createElement(re,null),l.a.createElement(c.EntityTable,{entities:a,filterState:t,bodyRowGenerator:i,headerRowGenerator:o,className:"ee-dates-list-list-view ee-fade-in",tableId:"date-entities-table-view",tableCaption:Object(r.__)("Event Dates"),onSort:n}))}))}}]);
//# sourceMappingURL=dates-table-view.e1e24fde.chunk.js.map